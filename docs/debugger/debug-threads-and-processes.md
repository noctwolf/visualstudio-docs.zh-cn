---
title: 调试线程和进程的工具 |Microsoft Docs
ms.date: 04/21/2018
ms.topic: conceptual
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- multiprocess debugging
- threading [Visual Studio], debugging
- processes, debugging
- debugging threads
- debugging [Visual Studio], threads
ms.assetid: 9f0c8505-b6b2-452b-adfd-076db14d8115
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: d4769224cfb26c4b1d55362fea006f55ba8845da
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "62852886"
---
# <a name="tools-to-debug-threads-and-processes-in-visual-studio"></a>若要调试线程和进程在 Visual Studio 中的工具
在计算机科学中，“线程”和“进程”是两个相关的概念。 二者都表示必须按特定顺序执行的指令序列。 但是不同线程或进程中的指令可以并行执行。

 进程存在于操作系统内，比如程序或应用程序。 而线程存在于进程内。 出于此原因，线程有时称为轻量进程。 每个进程都由一个或多个线程组成。 

 多个进程的存在使计算机能够同时执行多个任务。 而多个线程的存在使进程能够将工作分解、并行执行。 在多处理器计算机上，进程或线程可以在不同的处理器中运行。 这使真正的并行处理成为可能。

 完全并行处理并非总是能够得以实现。 有时必须同步线程。 一个线程可能必须等待另一个线程的结果，或者一个线程可能需要独占访问另一个线程正在使用的资源。 同步问题是多线程应用程序中出现 Bug 的一个常见原因。 有时候，线程可能最终等待的是永远不可用的资源。 这会导致一种称为“死锁”的情况。

 [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] 调试器为调试线程和进程提供了功能强大但易于使用的工具。

## <a name="tools-and-features"></a>工具和功能
[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] 中需要使用的工具取决于尝试调试的代码类型：

- 对于进程，主要工具是“附加到进程”对话框、“进程”窗口和“调试位置”工具栏。

- 对于线程，用于调试线程的主要工具是**线程**窗口中，源窗口中的线程标记**并行堆栈**窗口中，**并行监视**窗口中，并**调试位置**工具栏。

- 对于使用[任务并行库 (TPL)](/dotnet/standard/parallel-programming/task-parallel-library-tpl) 中的 <xref:System.Threading.Tasks.Task> 的代码，即[并发运行时](/cpp/parallel/concrt/concurrency-runtime/)（本机代码），调试多线程应用程序的主要工具是“并行堆栈”窗口、“并行监视”窗口和“任务”窗口（“任务”窗口也支持 JavaScript promise 对象）。

- 对于调试 GPU 上的线程，主要工具是“GPU 线程”窗口。

  下表显示了可用信息以及可在以上每个位置执行的操作：

|用户界面|可用信息|可以执行的操作|
|--------------------|---------------------------|-----------------------------|
|“附加到进程”对话框|可以附加的可用进程：<br /><br /> -   进程名 (.exe)<br />-   进程 ID 号<br />-   菜单栏标题<br />-   类型（托管 v4.0；托管 v2.0、v1.1、v1.0；x86；x64；IA64）<br />-   用户名（帐户名）<br />-   会话号|选择要附加的进程<br /><br /> 选择远程计算机<br /><br /> 更改用于连接远程计算机的传输类型|
|“进程”窗口|附加的进程：<br /><br /> -   进程名<br />-   进程 ID 号<br />-   进程 .exe 的路径<br />-   菜单栏标题<br />-   状态（中断 运行）<br />-   调试（本机、托管等。）<br />-   传输类型（默认、无身份验证时仅限本机）<br />-   传输限定符（远程计算机）|工具：<br /><br /> -   附加<br />-   拆离<br />-   终止<br /><br /> 快捷菜单：<br /><br /> -   附加<br />-   拆离<br />-   调试停止时拆离<br />-   终止|
|“线程”窗口|当前进程中的线程：<br /><br /> -   线程 ID<br />-   托管 ID<br />-   类别（主线程、接口线程、远程过程调用处理程序或辅助线程）<br />-   线程名<br />-   创建线程的位置<br />-   优先级<br />-   关联掩码<br />-   挂起的进程计数<br />-   进程名<br />-   标记指示器<br />-   挂起的指示器|工具：<br /><br /> -   搜索<br />-   搜索调用堆栈<br />-   标记“仅我的代码”<br />-   标记自定义模块选择<br />-   分组依据<br />-   列<br />-   展开/折叠调用堆栈<br />-   展开/折叠组<br />-   冻结/解冻线程<br /><br /> 快捷菜单：<br /><br /> -   在源中显示线程<br />-   切换到线程<br />-   冻结正在运行的线程<br />-   解冻冻结的线程<br />-   标记一个线程以便进一步研究<br />-   取消标记线程<br />-   重命名线程<br />-   显示和隐藏线程<br /><br /> 其他操作：<br /><br /> -   查看数据提示中一个线程的调用堆栈|
|源窗口|左侧滚动条槽中的线程指示符指示单线程或多线程（默认情况下处于关闭状态，可通过使用“线程”窗口中的快捷菜单打开）|快捷菜单：<br /><br /> -   切换到线程<br />-   标记一个线程以便进一步研究<br />-   取消标记线程|
|“调试位置”工具栏|-   当前进程<br />-   挂起应用程序<br />-   恢复应用程序<br />-   挂起并关闭应用程序<br />-   当前线程<br />-   切换当前线程标记状态<br />-   仅显示标记的线程<br />-   仅显示当前进程<br />-   当前堆栈帧|-   切换到另一个进程<br />-   挂起、恢复或关闭应用程序<br />-   切换到当前进程中的另一个线程<br />-   切换到当前线程中的另一个堆栈帧<br />-   标记或取消标记当前线程<br />-   仅显示标记的线程<br />-   仅显示当前进程|
|“并行堆栈”窗口|-   一个窗口中多个线程的调用堆栈。<br />-   每个线程的活动堆栈帧。<br />-   任何方法的调用方和被调用方。|-   筛选出指定的线程<br />-切换到任务视图<br />-   标记或取消标记线程<br />-   缩放|
|“并行监视”窗口|-   标记列，可在其中标记要特别注意的线程。<br />-   帧列，其中箭头指示选定的帧。<br />-   可配置的列，可显示计算机、进程、平铺、任务和线程。|-   标记或取消标记线程<br />-   仅显示标记的线程<br />-   切换帧<br />-   对列排序<br />-   对线程分组<br />-   冻结或解冻线程<br />-   导出“并行监视”窗口中的数据|
|**任务**窗口|-   查看有关 <xref:System.Threading.Tasks.Task> 对象的信息，包括任务 ID、任务状态（已计划、正在运行、正在等待和已死锁）以及分配给任务的线程。<br />-   调用堆栈中的当前位置。<br />-   在创建时传递给任务的委托|-   切换到当前任务<br />-   标记或取消标记任务<br />-   冻结或解冻任务|
|“GPU 线程”窗口|-   标记列，可在其中标记要特别注意的线程。<br />-当前线程列，其中的黄色箭头指示当前线程。<br />-   “线程计数”列，显示同一位置的线程数。<br />-   “行”列，显示每组线程所在的代码行。<br />-   “地址”列，显示每组线程所在的指令地址。<br />-   “位置”列，表示该地址的代码中的位置。<br />-   “状态”列，显示线程是活动的还是被阻止。<br />-   “平铺”列，显示行中的线程的平铺索引。|-将更改为不同的线程<br />-   显示特定平铺和线程<br />-   显示或隐藏列<br />-   按列排序<br />-   对线程分组<br />-   冻结或解冻线程<br />-   标记或取消标记线程<br />-   仅显示标记的线程|

## <a name="see-also"></a>请参阅

- [附加到正在运行的进程](../debugger/attach-to-running-processes-with-the-visual-studio-debugger.md)
- [调试多线程应用程序](../debugger/debug-multithreaded-applications-in-visual-studio.md)
- [调试 GPU 代码](../debugger/debugging-gpu-code.md)
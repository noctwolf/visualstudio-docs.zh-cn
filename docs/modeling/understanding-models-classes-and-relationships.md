---
title: 了解模型、类和关系
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Domain-Specific Language, models
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: d629c0049966d0520e0e40d23b0fd41798ccf2b6
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "63386987"
---
# <a name="understanding-models-classes-and-relationships"></a>了解模型、类和关系
域特定语言 (DSL) 是由其 DSL 定义文件定义，以及你可以编写任何自定义程序代码。 DSL 解决方案中的程序代码的大多数生成的此文件。

 本主题介绍 DSL 定义的主要功能。

## <a name="the-dsl-definition"></a>DSL 定义
 当你打开`Dsl\DslDefinition.dsl`，Visual Studio 窗口类似于下图。

 ![dsl 设计器](../modeling/media/dsl_designer.png)

 在 DSL 定义中最重要的信息显示在 DSL 定义关系图。 其他信息，也是 DslDefinition.dsl 的一部分，显示在 DSL 资源管理器，它通常显示在关系图的一端。 你处理的最常见的任务中，关系图和 DSL 资源管理器对于更高级的自定义项。

 DSL 定义关系图显示了定义模型元素和定义链接模型元素之间的关系的域类。 它还显示形状和连接线，用于向用户显示的模型元素。

 ![具有泳道的 dsl 设计器](../modeling/media/dsl_desinger.png)

 在 DSL 定义中，在关系图或 DSL 资源管理器中选择项时在属性窗口中显示与其有关的信息。 可能在 DSL 详细信息窗口中显示的其他信息。

### <a name="models-are-instances-of-dsls"></a>模型是 Dsl 的实例
 一个*模型*是用户创建的 DSL 的实例。 模型包含模型元素，它们是实例的定义，请在域类和元素，它们是您定义的域关系的实例之间的链接。 一个模型还可以有形状和连接线，关系图显示的模型元素和链接。 DSL 定义中包括形状类、 连接器类和关系图的类。

 DSL 定义是也称为*域模型*。 DSL 定义或域模型是语言的语言的特定于域的设计时表示形式，而该模型是语言的语言的特定于域的运行时实例化。

## <a name="domain-classes-define-model-elements"></a>域类定义模型元素
 域类用于在域中创建的各种元素，并且域关系是在元素之间的链接。 它们是元素和链接将进行实例化的设计特定于语言的用户在创建其模型时的设计时表示形式。

 此图显示了音乐库 DSL 的用户已创建一个模型。 由包含的歌曲列表的复选框表示音乐 album。 艺术家都是圆角的框，并连接到它们提供到相册。

 ![生成的 DSL 实例模型](../modeling/media/music_instance.png)

 DSL 定义用于分隔两个方面。 使用形状类和连接器类定义模型关系图上的模型元素的外观。 使用域类和域关系执行模型中的信息进行定义。

 下图显示音乐库在 DSL 定义中的域类和关系。

 ![嵌入关系和引用关系](../modeling/media/music_classes.png)

 该图显示了四个域类：音乐、 相册、 艺术家和歌曲。 域类定义域属性，例如名称、 标题和等等。 在实例模型中，关系图上显示的其中一些属性的值。

 在类之间是域关系：MusicHasAlbums、 MusicHasArtists、 AlbumbHasSongs 和 ArtistAppearedOnAlbums。 这些关系具有重数 1..1，例如 0..*。 例如，必须与通过 AlbumHasSongs 关系恰好一个唱片集相关的所有首歌。 每个唱片集可以有任意数量的歌曲。

### <a name="rearranging-the-dsl-definition-diagram"></a>重新排列的 DSL 定义关系图
 请注意，域类可以在 DSL 定义关系图中上, 出现多次，唱片集一样在此图中。 始终有一个主视图中，最可能有一些*引用*视图。

 若要重新排列的 DSL 定义关系图，您可以：

- 交换主并通过引用视图**将树放在此处**并**拆分树**命令。 右键单击单个域类，若要查看这些命令。

- 通过按 Ctrl + Up 和 Ctrl + 向下进行重新排序的域类和形状类。

- 折叠或展开类在每个形状的右上方使用的图标。

- 通过单击底部的域类减号 （-） 折叠树的部分。

## <a name="inheritance"></a>继承
 可以使用继承定义域类。 若要创建继承派生，单击继承工具，单击派生的类，然后单击类的基类。 模型元素具有其自己的域类，以及从基类继承的所有属性定义的所有属性。 它还继承关系中的其角色。

 之间的关系、 形状和连接器，还可以使用继承。 继承必须保持相同的组中。 形状不能从一个域类继承。

## <a name="domain-relationships"></a>域关系
 可以通过关系链接模型元素。 链接始终是二进制;这些链接两个元素。 但是，任何元素都可以有许多链接到其他对象，并且甚至可以相同的元素对之间的多个链接。

 正如您可以定义不同类的元素，可以定义不同类的链接。 链接的类称为*域关系*。 域关系指定其实例可连接元素的哪些类。 名为关系的每一端*角色*，和域关系定义为两个角色，以及关系本身的名称。

 有两种类型的域关系： 嵌入关系和引用关系。 在 DSL 定义关系图中，嵌入关系可以从每个角色，实线和引用关系虚线。

### <a name="embedding-relationships"></a>嵌入关系
 在模型中，除了其根，每个元素是链接的一个嵌入的目标。 因此，整个模型构成单个树的嵌入的链接。 嵌入关系表示包含或所有权。 以这种方式相关的两个模型元素也被称为父级和子级。 子称为父中嵌入。

 嵌入的链接不通常会显示显式用作关系图上的连接器。 相反，它们通常包含由表示。 关系图中，由表示模型的根和嵌入其中的元素显示为关系图上的形状。

 在示例中，根类音乐具有 MusicHasAlbums 到唱片集、 具有嵌入 AlbumHasSongs 到 Song 的嵌入关系。 为每个唱片集内的列表中的项显示的歌曲。 音乐还具有为其实例也显示为关系图上形状的艺术家类嵌入 MusicHasArtists。

 默认情况下，会删除其父项时，会自动删除嵌入的元素。

 当将模型保存到文件以 XML 形式，嵌入的元素都放在其父项，除非自定义序列化。

> [!NOTE]
> 嵌入与继承不同。 中的嵌入关系的子级不继承父项的属性。 嵌入是链接的一种模型元素之间。 继承类之间的关系并不会创建模型元素之间的链接。

### <a name="embedding-rules"></a>嵌入的规则
 实例模型中的每个元素必须是一个嵌入链接，但模型根除外的目标。

 因此，每个非抽象域类，除根类，必须至少一个嵌入关系的目标或它必须嵌入从基类继承。 一个类可以是两个或多个嵌入的目标，但其实例模型元素一次只能有一个父级。 从目标到源的多重性必须为 0..1 或 1..1。

### <a name="the-explorer-displays-the-embedding-tree"></a>在资源管理器显示嵌入树
 DSL 定义还会创建一个资源管理器，该用户会看到其模型关系图旁边。

 ![生成的 DSL 资源管理器](../modeling/media/music_explorer.png)

 在资源管理器在模型中，甚至那些不为其定义的所有形状显示的所有元素。 它显示了元素和嵌入关系，但不能引用关系。

 若要查看域属性的元素的值，用户可选择一个元素，在模型关系图中或在模型资源管理器，并打开属性窗口。 它会显示所有域属性，包括那些未显示在关系图上。 在示例中，每首歌曲有一个标题和一种流派，但只有标题的值显示在关系图上。

## <a name="reference-relationships"></a>引用关系
 引用关系表示任何类型的而非嵌入关系。

 引用关系通常在关系图上显示为形状之间的连接器。

 在该模型的 XML 表示形式，使用表示两个元素之间的引用链接*名字对象。* 也就是说，名字对象是唯一标识模型中的每个元素的名称。 每个模型元素的 XML 节点包含指定的关系的名称和其他元素的名字对象的节点。

## <a name="roles"></a>角色
 每个域关系具有两个角色、 源角色和目标角色。

 在下面的图中，点之间的线条**发布服务器**域类和**PublisherCatalog**域之间的关系是源角色。 域关系之间的界限并**唱片集**域类是目标角色。

 ![角色和属性。](../modeling/media/propertycode.png)

 编写程序代码遍历该模型时，与关系关联的名称是尤为重要。 例如，生成 DSL 解决方案时，生成的类发布者将有一个属性是一系列唱片集的目录。 唱片集的类有一个属性是类发布服务器的单个实例的发布服务器。

 当在 DSL 定义中创建关系时，属性和关系名称赋予默认值。 但是，你可以更改它们。

## <a name="multiplicities"></a>重数
 重数指定的元素数量可以在域关系中具有相同的角色。 在示例中，对多零 (0..\*) 上的重数设置**目录**角色指定的任何实例**发布服务器**域类可以有任意多个**PublisherCatalog**关系链接作为你想要为其提供。

 通过键入关系图上或通过修改配置的角色多重性`Multiplicity`中的属性**属性**窗口。 下表描述此属性的设置。

|重数类型|描述|
|-|-|
|0..* （从零到多个）|域类的每个实例可以有多个实例的关系的任何实例。|
|0..1 (0 到 1)|域类的每个实例可以有多个实例的关系的任何实例。|
|1..1 （一个）|域类的每个实例可以有关系的一个实例。 无法从任何角色类的实例来创建此关系的多个实例。 如果启用验证，则当角色类的任何实例都不具有关系的任何实例时，将出现验证错误。|
|1..* （一个到多个）|每个实例上的此重数的角色的类可以有多个实例的关系，和每个实例都必须具有至少一个实例的关系。 如果启用验证，则当角色类的任何实例都不具有关系的任何实例时，将出现验证错误。|

## <a name="domain-relationships-as-classes"></a>作为类的域关系
 链接表示为 LinkElement，它是 ModelElement 派生的类的实例存储区中。 可以在域模型关系图上的域关系中定义这些属性。

 您还可以使关系的源或其他关系的目标。 在域模型关系图中，右键单击域关系，然后单击**显示为类**。 将出现其他类。 然后可以与其连接的关系。

 就像使用域类一样，可以部分地由继承，定义关系。 选择派生的关系，并设置**基关系**属性窗口中。

 派生的关系进行专用化其基关系。 域类的链接应派生自它或通过基关系链接的类相同。 在模型中创建派生的链接时，它是关系的派生和基关系的实例。 在程序代码中，您可以导航到相对的一端使用基类或派生类生成的属性的链接。

## <a name="see-also"></a>请参阅

- [域特定语言工具术语表](https://msdn.microsoft.com/ca5e84cb-a315-465c-be24-76aa3df276aa)
